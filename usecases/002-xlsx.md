# 电子表格处理

> AI 处理电子表格进展到什么程度了？

## 用例场景

- 财务报表分析与建模
- 销售数据汇总分析
- 复杂表格的公式生成

## 核心 Skill

| 类型 | 名称 | 来源 |
|------|------|------|
| Skill | xlsx | [Anthropic 官方](https://github.com/anthropics/skills/blob/main/skills/xlsx/SKILL.md) |

## 评分

| 维度 | 分数 | 说明 |
|------|------|------|
| 效果 | 4 | 基本解决问题，复杂任务偶有遗漏 |
| 复现成本 | 3 | 安装 LibreOffice 可获得更好效果 |
| 稳定性 | 4 | 偶尔「偷懒」使用硬编码 |
| 速度 | 4 | 几分钟完成复杂报表 |
| 可扩展性 | 5 | 开源可定制，可改成自己的规范 |
| 兼容性 | 4 | Claude Code / OpenCode / Codex 均可用 |

**综合评分：4.0/5**

## 技术拆解

### 1) 公式驱动

xlsx skill 有一条铁律：**永远用公式，不要硬编码计算结果**。

AI 制表时可能直接填入算出来的数值 `45000`，但规范做法应该是只生成公式，让 Excel/WPS 打开时自动计算。

硬编码的值是「死」的——源数据一改就错了；公式是「活」的，数据变了会自动更新。

### 2) 华尔街投行规范

Skill 内置了财务模型的颜色编码标准：

| 颜色 | 含义 |
|------|------|
| 蓝色 | 硬编码的用户输入值 |
| 黑色 | 公式计算值 |
| 绿色 | 引用值 |

这是高盛、摩根士丹利、JP 摩根等华尔街投行的内部培训标准。

### 3) 工具使用

| 工具 | 职责 |
|------|------|
| pandas | 数据分析、批量操作 |
| openpyxl | 处理格式、写入公式 |
| LibreOffice | 计算公式的实际结果 |

**小贴士**：安装 LibreOffice 可获得更好效果。Skill 包含的 `recalc.py` 脚本会使用 LibreOffice 的无头模式帮你计算公式、收集结果和错误，让 AI 能自我校正。

## 横向评测

### 测试任务

处理一份包含 4000+ 条记录、24 个月数据的销售文件，填写月度汇总表和产品分析表。

**Prompt:**
```
拷贝销售数据 sales_analytics_template.xlsx 到 outputs/result.xlsx, 帮我做数据分析。

1. "月度汇总"表 - 算出24个月的总销售额、销量，同比、环比，完成率，
   完成不好的标颜色提醒
2. "产品分析"表 - 8个产品的销售额、增长率、毛利率，产品ABC分类，
   给出建议
```

### 对比结果

| 产品 | 效果 | 公式驱动 | 评价 |
|------|------|---------|------|
| **xlsx Skill** | 准确填写，格式美观 | 部分遵循 | 第一梯队 |
| WPS (DeepSeek) | 数据准确 | 否 | 格式不美观，无法读取选中内容 |
| Skywork | 做了可视化图表 | - | 不能下载修改后的表格 |
| Google Sheet Gemini | 只能读当前 sheet | - | 无法完成跨表单任务 |
| **Formula Bot** | 效果优秀，主动用颜色标注 | 否 | 第一梯队，与 Skill 相当 |

## 适用场景

| 场景 | 推荐程度 |
|------|----------|
| 财务报表分析与建模，需要自动化处理 | 完美契合 |
| 处理复杂表格，需要使用公式 | 可以用 |
| 一次性的简单表格处理，不需要公式 | 可有可无 |

## 局限

- 复杂任务中大模型可能「忘记」Skill 规范要求
- 有时会出现数据填错列的情况
- 意图精确表达需要提示词迭代

## 在 OpenAI Codex 中使用

Codex 已完全支持 Agent Skills。运行以下命令安装：

```bash
$skill-installer https://github.com/anthropics/skills/blob/main/skills/xlsx/SKILL.md
```

注意：网页端 Codex 和 ChatGPT 目前还不支持。

## 结论

通用 Agent + Skill 的模式与垂类 Agent 的最大差别：**开源 vs 闭源**。

- Agent Skills 可定制、可扩展，可以看到全部逻辑，可以 fork 改成自己想要的样子
- 垂类 Agent 需要适应他们的交互方式，还要额外付费

你会选择哪种？
